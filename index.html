<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Market Dashboard</title>

<style>
body {
  margin: 0;
  font-family: "Courier New", monospace;
  background: #f4f4f4;
}

/* ---------- Global Tabs ---------- */
.topbar {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  background: #1e1e1e;
  color: white;
  padding: 8px;
}

.tab {
  padding: 6px 12px;
  cursor: pointer;
  background: #333;
  border-radius: 4px;
  white-space: nowrap;
}

.tab.active {
  background: #007acc;
}

/* ---------- App Area ---------- */
#app {
  padding: 0;
}
</style>
</head>

<body>

<!-- Global Tab Bar -->
<div class="topbar" id="globalTabs"></div>

<!-- Feature Content -->
<div id="app"></div>

<script>
const globalTabs = document.getElementById("globalTabs");
let firstTabActivated = false;

/* Global tab registration API */
window.registerTabs = function (tabBuilderFn) {
  tabBuilderFn(addGlobalTab);
};

/* Add tab to global bar */
function addGlobalTab(label, onClick) {
  const div = document.createElement("div");
  div.className = "tab";
  div.innerText = label;

  div.onclick = () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    div.classList.add("active");
    onClick();
  };

  globalTabs.appendChild(div);

  /* Auto-activate first tab */
  if (!firstTabActivated) {
    firstTabActivated = true;
    div.click();
  }
}

/* Load portfolio first */
fetch("portfolio.html")
  .then(r => r.text())
  .then(html => {
    const app = document.getElementById("app");
    app.innerHTML = html;

    /* Execute embedded scripts */
    app.querySelectorAll("script").forEach(oldScript => {
      const s = document.createElement("script");
      s.textContent = oldScript.textContent;
      document.body.appendChild(s);
      oldScript.remove();
    });
  });
</script>

</body>
</html>
